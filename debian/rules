#!/usr/bin/make -f

PACKAGE = linkchecker
ROOT = $(CURDIR)/debian/$(PACKAGE)
DOCDIR = $(ROOT)/usr/share/doc/$(PACKAGE)
PYTHON = python
CGIDIR = $(ROOT)/usr/lib/cgi-bin/lconline
HTMLDIR = $(ROOT)/var/www/lconline
SHARE = $(ROOT)/usr/share/linkchecker
ETC = $(ROOT)/etc

include /usr/share/cdbs/1/rules/debhelper.mk

binary-post-install/linkchecker::
	$(MAKE) locale
	$(PYTHON) setup.py install --root=$(ROOT) --no-compile
# remove example files, we install them below
	rm -r $(ROOT)/usr/share/linkchecker/examples
# install CGI files
	install -m 644 cgi/lconline/*.html $(HTMLDIR)
	install -m 644 cgi/lconline/*.de $(HTMLDIR)
	install -m 644 cgi/lconline/*.en $(HTMLDIR)
	install -m 644 cgi/lconline/check.js $(HTMLDIR)
	install -m 755 cgi/lc.cgi $(CGIDIR)
	install -m 755 cgi/lc.fcgi $(CGIDIR)
# install system wide configuration files in etc
	install -m 644 $(SHARE)/linkcheckerrc $(ETC)/linkchecker/
	install -m 644 $(SHARE)/logging.conf $(ETC)/linkchecker/
# install bash_completion script
	install -m 644 config/linkchecker-completion $(ETC)/bash_completion.d
# install lintian overrides
	install -m 644 debian/linkchecker.lintian $(ROOT)/usr/share/lintian/overrides/linkchecker
	dh_python

